{"version":3,"sources":["athens/devcards/block_page.cljs"],"mappings":"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","names":["p__65661","map__65662","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","athens.devcards.block-page/block-page-el","string","children","uid","parents","editing-uid","iter__4582__auto__","s__65665","cljs.core/LazySeq","temp__5735__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4580__auto__","size__4581__auto__","cljs.core/count","b__65667","cljs.core/chunk-buffer","i__65666","cljs.core._nth.cljs$core$IFn$_invoke$arity$2","map__65668","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__65664","cljs.core/chunk-rest","cljs.core/first","map__65670","cljs.core/cons","cljs.core/rest","p","title","athens.router/navigate-uid","or__4185__auto__","cljs.core.interpose.cljs$core$IFn$_invoke$arity$2","cljs.core.map.cljs$core$IFn$_invoke$arity$2","x","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","reagent.core/adapt-react-class","js/module$node_modules$$material_ui$icons$index.ChevronRight","stylefy.core.use_style.cljs$core$IFn$_invoke$arity$1","komponentit.autosize/textarea","e","G__65672","re-frame.core/dispatch","s__65674","b__65676","i__65675","iter__65673","child","athens.devcards.blocks/block-el","athens.devcards.block-page/block-page-component","id","cljs.core/deref","block","G__65677","G__65678","G__65679","posh.reagent/pull","athens.db/dsdb","G__65680","G__65681","G__65682","athens.db/shape-parent-query","G__65684","re-frame.core/subscribe","cljs.core/chunk-first"],"sourcesContent":["(ns athens.devcards.block-page\n  (:require\n    [\"@material-ui/icons\" :as mui-icons]\n    [athens.db :as db]\n    [athens.devcards.blocks :refer [block-el]]\n    [athens.router :refer [navigate-uid]]\n    [cljsjs.react]\n    [cljsjs.react.dom]\n    [devcards.core :refer-macros [defcard-rg]]\n    [komponentit.autosize :as autosize]\n    [posh.reagent :refer [pull]]\n    [re-frame.core :refer [subscribe dispatch]]\n    [reagent.core :as r]\n    [stylefy.core :refer [use-style]]))\n\n\n;;; Components\n\n\n(defn block-page-el\n  [{:block/keys [string children uid]} parents editing-uid]\n  [:div\n   ;; Parent Context\n   [:span {:style {:color \"gray\"}}]\n   (->> (for [p parents\n              :let [{:keys [node/title block/uid block/string]} p]]\n          [:span {:key uid :style {:cursor \"pointer\"} :on-click #(navigate-uid uid)} (or string title)])\n        (interpose \">\")\n        (map (fn [x]\n               (if (= x \">\")\n                 [(r/adapt-react-class mui-icons/ChevronRight) (use-style {:vertical-align \"middle\"})]\n                 x))))\n\n   ;; Header\n   [:div {:data-uid uid :class \"block-header\"}\n    (if (= uid editing-uid)\n      [:h1 [autosize/textarea\n            {:value       string\n             :style       {:width \"100%\"}\n             :auto-focus  true\n             ;; TODO debounce\n             :on-change   (fn [e] (dispatch [:transact-event [[:db/add [:block/uid uid] :block/string (.. e -target -value)]]]))}]]\n      [:h1 (str \"\u2022 \" string)])]\n\n   ;; Children\n   [:div\n    (for [child children]\n      ^{:key (:db/id child)} [block-el child])]])\n\n\n(defn block-page-component\n  [id]\n  (let [block   @(pull db/dsdb '[:db/id :block/uid :block/string :block/open :block/order {:block/children ...}] id)\n        parents (->> @(pull db/dsdb '[:node/title :block/string :block/uid {:block/_children ...}] id)\n                     db/shape-parent-query)\n        editing-uid @(subscribe [:editing-uid])]\n    [block-page-el block parents editing-uid]))\n\n\n;;; Devcards\n\n\n(defcard-rg Block-Page\n  \"pull entity 2347: a block within Athens FAQ\"\n  [block-page-component 2347])\n"]}